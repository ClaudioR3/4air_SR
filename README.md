# 4AIR Project

The code is related to ENEA's scientific work. 
In the present work, we use and compare four different neural networks (SRMD, RCAN, ESRGAN and SwinIR) for the task of Super Resolution on air quality domain.

The code is based on the Official GitHub project https://github.com/cszn/KAIR .


## How to install
The file of requirement has been uploaded to allow you to install easily the conda environment.
Use the terminal or an Anaconda Prompt for the following steps:

 1. Create the environment from the `environment.yml` file:

 ```commandline
 conda env create -f environment.yml
 ```

 2. Activate the new environment:

 ```commandline
 conda activate 4air_sr
 ```

 3. Verify that the new environment was installed correctly:

 ```commandline
 conda env list
 ```

## Dataset
The dataset generated by FARM (Flexible Air quality Regional Model) from January 2019 to December 2021. It's composed of numpy (npy) files, which collect air pollutant concentration levels, i.e. carbon monoxide, nitrogen dioxide and ozone, at the sea level.

Overall, there are two types of FARM data, the low and the high resolution one. Low resolution (LR) data have 56 points as longitudes and 62 points as latitudes, representing the atmospheric concentrations on a lattice of 20 Km. Instead, high resolution (HR) data have 276 points as longitudes and 306 points as latitudes, representing the reticular atmospheric concentrations on a lattice of 4 Km.

Furthermore, there are two different dataset. The first one, is based on considering separately the three variables and is called 1D. The second one considers the three variables together and is called 3D.

You can download the 4AIR's data set [here](https://zenodo.org/record/7458663#.Y8Z0qXbMJD8).

## Get start
### How to train
Run the following command line in order to train the NN with 1D dataset

```commandline
python main_infer.py --opt options/<nn>/train_<nn>X5_3D.json
```

Run the following command line in order to train the NN with 3D dataset

```commandline
python main_infer.py --opt options/<nn>/train_<nn>X5_3D.json
```

### How to test
Run the following command line in order to test the NN with 1D dataset

```commandline
python main_infer.py --opt options/<nn>/test_<nn>X5_1D.json
```

Run the following command line in order to test the NN with 3D dataset

```commandline
python main_infer.py --opt options/<nn>/test_<nn>X5_3D.json
```

### How to infer
Run the following command line in order to infer the NN with 1D dataset

```commandline
python main_infer.py --opt options/<nn>/infer_<nn>X5_1D.json
```

Run the following command line in order to infer the NN with 3D dataset

```commandline
python main_infer.py --opt options/<nn>/infer_<nn>X5_3D.json
```



